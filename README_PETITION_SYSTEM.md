# 请愿书系统

本系统已从投票系统成功转换为请愿书系统，支持富文本内容编辑和调查问卷功能。

## 🚀 新功能特性

### 1. 请愿书功能
- ✅ 支持富文本编辑的请愿书标题和内容
- ✅ 数字签名支持（手写签名板）
- ✅ 手机号码防重复签名机制
- ✅ 签名统计和拼图展示

### 2. 调查问卷功能
- ✅ 富文本编辑的问卷标题
- ✅ 单选题和多选题支持
- ✅ 去掉了图片功能（按需求）
- ✅ 问卷结果统计和可视化

### 3. 管理后台
- ✅ 创建请愿书（富文本编辑器）
- ✅ 添加/编辑调查问卷
- ✅ 设置问题类型（单选/多选）
- ✅ 管理问卷选项

### 4. 结果展示
- ✅ 请愿书支持人数统计
- ✅ 调查问卷结果可视化
- ✅ 签名拼图展示
- ✅ 打印功能

## 📊 数据模型

### 新的数据库结构：
- **Petition** - 请愿书主表
- **Survey** - 调查问卷
- **SurveyOption** - 问卷选项
- **Signature** - 支持签名记录
- **SurveyResponse** - 问卷回答

## 🛠 技术栈

- **前端**: Next.js 14 + React + TypeScript + Tailwind CSS
- **富文本编辑器**: React Quill
- **数据库**: PostgreSQL + Prisma ORM
- **签名功能**: HTML5 Canvas
- **样式**: Tailwind CSS + Typography Plugin

## 📋 使用说明

### 管理员操作
1. 访问 `/admin` 创建请愿书
2. 输入请愿书标题和富文本内容
3. 添加调查问卷（可选）
4. 设置问题类型（单选/多选）
5. 添加问卷选项
6. 发布请愿书

### 用户操作
1. 访问首页查看请愿书内容
2. 完成调查问卷（如有）
3. 输入姓名和手机号码
4. 完成手写签名
5. 提交支持

### 查看结果
- 访问 `/results` 查看支持情况
- 查看调查问卷统计结果
- 查看签名拼图

## 🔧 安装和运行

### 环境要求
- Node.js 18+
- PostgreSQL 数据库

### 安装依赖
```bash
npm install
```

### 数据库设置
1. 启动 PostgreSQL 数据库
2. 配置 `.env` 文件中的数据库连接
3. 运行数据库迁移：
```bash
npx prisma migrate dev
```

### 启动开发服务器
```bash
npm run dev
```

## 📝 主要变更

### 从投票系统到请愿书系统的变更：
1. **数据模型重构** - 从Poll/Vote改为Petition/Signature
2. **富文本支持** - 请愿书内容和问卷标题支持富文本编辑
3. **调查问卷增强** - 支持单选/多选，去除图片功能
4. **UI/UX优化** - 更适合请愿书场景的界面设计
5. **术语更新** - 所有相关文案从"投票"改为"请愿书支持"

## 🎯 待办事项

当数据库环境就绪后：
- [ ] 运行数据库迁移： `npx prisma migrate dev --name petition_system_redesign`
- [ ] 测试所有功能
- [ ] 部署到生产环境

## 📞 技术支持

如有技术问题，请参考：
- Prisma文档：https://www.prisma.io/docs
- React Quill文档：https://github.com/zenoamaro/react-quill
- Next.js文档：https://nextjs.org/docs
